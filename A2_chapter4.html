<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>第四課 試算表函數速覽</title>
<style>
    :root { color-scheme: light; }
    body {
        margin: 0;
        font-family: "Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif;
        background: #f4f6fb;
        color: #0f172a;
        line-height: 1.6;
    }
    main {
        max-width: 1040px;
        margin: 0 auto;
        padding: 32px 16px 64px;
    }
    h1 {
        text-align: center;
        margin-bottom: 16px;
        font-size: 2rem;
    }
    section {
        background: #fff;
        border-radius: 18px;
        padding: 22px;
        margin-bottom: 20px;
        box-shadow: 0 18px 40px rgba(15,23,42,0.12);
    }
    h2 {
        font-size: 1.3rem;
        margin: 0 0 12px;
        color: #0f172a;
    }
    h3 {
        font-size: 1.05rem;
        margin: 18px 0 8px;
        color: #0f172a;
    }
    .grid {
        display: grid;
        gap: 14px;
    }
    .grid-2 {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }
    .card {
        border: 1px solid #e2e8f0;
        border-radius: 14px;
        padding: 16px;
        background: #f9fbff;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        min-width: 640px;
    }
    th, td {
        border: 1px solid #dbe1f1;
        padding: 10px 12px;
        text-align: left;
        vertical-align: top;
    }
    th {
        background: #e8eeff;
        font-weight: 600;
    }
    .table-wrap {
        overflow-x: auto;
    }
    code {
        font-family: "JetBrains Mono","Fira Code",monospace;
        background: #edf2ff;
        padding: 0 6px;
        border-radius: 8px;
    }
    ul {
        padding-left: 18px;
        margin: 8px 0;
    }
    .badge {
        display: inline-block;
        padding: 2px 10px;
        border-radius: 999px;
        font-size: 0.82rem;
        font-weight: 600;
        color: #0f172a;
        background: #e0f2fe;
        margin-bottom: 6px;
    }
    @media (max-width: 640px) {
        section { padding: 18px; }
        table { font-size: 0.95rem; }
    }
</style>
</head>
<body>
<main>
    <h1>第四課 ︱ 試算表函數速覽</h1>

    <section id="logic">
        <div class="badge">邏輯運算</div>
        <div class="table-wrap">
            <table>
                <thead>
                    <tr>
                        <th>函數</th>
                        <th>用途</th>
                        <th>示例</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>AND(條件…)</code></td>
                        <td>所有條件皆 TRUE 才回傳 TRUE。</td>
                        <td><code>=AND(B2>=60, C2="合格")</code></td>
                    </tr>
                    <tr>
                        <td><code>OR(條件…)</code></td>
                        <td>任一條件 TRUE 即 TRUE。</td>
                        <td><code>=OR(D2="M", D2="F")</code></td>
                    </tr>
                    <tr>
                        <td><code>NOT(條件)</code></td>
                        <td>反轉 TRUE / FALSE。</td>
                        <td><code>=NOT(E2="完成")</code></td>
                    </tr>
                    <tr>
                        <td><code>IF(條件, 真值, 假值)</code></td>
                        <td>根據條件輸出不同結果。</td>
                        <td><code>=IF(F2>=50,"合格","不合格")</code></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3>IF 函數進階筆記</h3>
        <div class="grid grid-2">
            <div class="card">
                <strong>巢狀 IF（多級評分）</strong>
                <p><code>=IF(B2>=80,"A",IF(B2>=65,"B",IF(B2>=50,"C","D")))</code></p>
                <ul>
                    <li>由高到低排序，先符合先回傳。</li>
                    <li>常用於等第、獎勵、風險等多層判斷。</li>
                </ul>
            </div>
            <div class="card">
                <strong>IF + AND / OR 組合</strong>
                <p><code>=IF(AND(C2>=50,D2<=3),"通過","需複檢")</code><br>
                   <code>=IF(OR(E2="優秀",E2="良好"),"列入名單","")</code></p>
                <ul>
                    <li>AND：所有條件必須成立。</li>
                    <li>OR：任一條件成立即可。</li>
                </ul>
            </div>
            <div class="card">
                <strong>IF 輸出數值/公式</strong>
                <p><code>=IF(G2="VIP", H2*0.9, H2)</code></p>
                <ul>
                    <li>可回傳文字、數字、甚至另一個公式。</li>
                    <li>適合做折扣、加成、附加費等邏輯。</li>
                </ul>
            </div>
            <div class="card">
                <strong>IF + 文字函數</strong>
                <p><code>=IF(LEFT(I2,1)="A","A 系列","其他")</code></p>
                <ul>
                    <li>先用文字函數取得關鍵片段，再以 IF 判斷類別。</li>
                </ul>
            </div>
        </div>
    </section>

    <section id="text">
        <div class="badge">文字處理</div>
        <div class="table-wrap">
            <table>
                <thead>
                    <tr>
                        <th>函數</th>
                        <th>功能</th>
                        <th>示例</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>LEFT(文字, 字元數)</code></td>
                        <td>從左邊擷取指定字數。</td>
                        <td><code>=LEFT("ITP402",3)</code> → <code>ITP</code></td>
                    </tr>
                    <tr>
                        <td><code>MID(文字, 起始, 長度)</code></td>
                        <td>由中間起取字。</td>
                        <td><code>=MID("ITP402",4,2)</code> → <code>40</code></td>
                    </tr>
                    <tr>
                        <td><code>RIGHT(文字, 字元數)</code></td>
                        <td>由右邊取字。</td>
                        <td><code>=RIGHT("ITP402",2)</code> → <code>02</code></td>
                    </tr>
                    <tr>
                        <td><code>UPPER(文字)</code></td>
                        <td>全部轉大寫。</td>
                        <td><code>=UPPER("hello")</code> → <code>HELLO</code></td>
                    </tr>
                    <tr>
                        <td><code>LOWER(文字)</code></td>
                        <td>全部轉小寫。</td>
                        <td><code>=LOWER("Hello")</code> → <code>hello</code></td>
                    </tr>
                    <tr>
                        <td><code>PROPER(文字)</code></td>
                        <td>每個字首字母大寫。</td>
                        <td><code>=PROPER("hong kong")</code> → <code>Hong Kong</code></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>

    <section id="stat">
        <div class="badge">統計 / 數值</div>
        <div class="table-wrap">
            <table>
                <thead>
                    <tr>
                        <th>函數</th>
                        <th>功能</th>
                        <th>示例</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>SUM(範圍)</code></td>
                        <td>總和。</td>
                        <td><code>=SUM(B2:B10)</code></td>
                    </tr>
                    <tr>
                        <td><code>SUMIF(條件範圍, 條件, [加總範圍])</code></td>
                        <td>符合條件的資料才累加。</td>
                        <td><code>=SUMIF(A2:A10,"文科",C2:C10)</code></td>
                    </tr>
                    <tr>
                        <td><code>AVERAGE(範圍)</code></td>
                        <td>平均值。</td>
                        <td><code>=AVERAGE(D2:D8)</code></td>
                    </tr>
                    <tr>
                        <td><code>MAX(範圍)</code></td>
                        <td>最大值。</td>
                        <td><code>=MAX(E2:E20)</code></td>
                    </tr>
                    <tr>
                        <td><code>MIN(範圍)</code></td>
                        <td>最小值。</td>
                        <td><code>=MIN(E2:E20)</code></td>
                    </tr>
                    <tr>
                        <td><code>COUNT(範圍)</code></td>
                        <td>計算含數值的儲存格數。</td>
                        <td><code>=COUNT(F2:F40)</code></td>
                    </tr>
                    <tr>
                        <td><code>COUNTIF(範圍, 條件)</code></td>
                        <td>計算符合條件的個數。</td>
                        <td><code>=COUNTIF(G2:G40,">=80")</code></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>
</main>
</body>
</html>
